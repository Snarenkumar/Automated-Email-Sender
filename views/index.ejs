<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel File Upload</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #drop-area {
            width: 400px;
            height: 200px;
            margin: 20px auto;
            text-align: center;
            line-height: 200px;
            border: 2px dashed #ccc;
            cursor: pointer;
        }
        #drop-area.drag-over {
            background-color: #eee;
        }
        table {
            margin: 20px auto;
            border-collapse: collapse;
            width: 80%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

    <h1>Drag & Drop Excel File to Upload</h1>

    <form id="upload-form" action="/upload" method="POST" enctype="multipart/form-data">
        <div id="drop-area">
            Drag Excel File Here or Click to Upload
            <input type="file" id="file-input" name="excelFile" accept=".xls,.xlsx" hidden>
        </div>
        <button type="submit">Upload</button>
    </form>

    <% if (excelData) { %>
        <h2>Email Addresses:</h2>
        <ul>
            <% excelData.forEach(email => { %>
                <li><%= email %></li>
            <% }) %>
        </ul>
    <% } %>

    <script>
        const dropArea = document.getElementById('drop-area');
        const fileInput = document.getElementById('file-input');

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(event => {
            dropArea.addEventListener(event, preventDefaults);
        });

        dropArea.addEventListener('dragover', () => dropArea.classList.add('drag-over'));
        dropArea.addEventListener('dragleave', () => dropArea.classList.remove('drag-over'));

        dropArea.addEventListener('drop', (e) => {
            dropArea.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            
            if (files.length > 0) {
                fileInput.files = files;
                document.getElementById('upload-form').submit();
            }
        });

        dropArea.addEventListener('click', () => fileInput.click());
    </script>

</body>
</html>
